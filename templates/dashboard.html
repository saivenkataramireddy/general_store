{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard | SJMS Store</title>

<style>
    body {
        background:#0d0d0d;
        color:#fff;
        font-family:'Poppins';
        padding:20px;
    }

    h1 {
        color:#00eaff;
        text-align:center;
        margin-bottom:20px;
    }

    .cards {
        display:grid;
        grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
        gap:20px;
        margin-bottom:30px;
    }

    .card {
        background:#111;
        padding:25px;
        border-radius:12px;
        text-align:center;
        box-shadow:0px 0px 10px rgba(0,255,255,0.2);
    }

    canvas {
        width:100%;
        background:#111;
        padding:20px;
        border-radius:10px;
    }

    .back-btn {
        display:inline-block;
        padding:10px 20px;
        background:#00eaff;
        color:#000;
        border-radius:30px;
        text-decoration:none;
        margin-top:20px;
        font-weight:600;
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1> Store Admin Dashboard</h1>
<div style="text-align:center; margin-bottom:20px;">
    <a href="{% url 'add_product' %}" class="back-btn">‚ûï Add Product</a>
</div>

<div class="cards">
    <div class="card">
        <h3>Total Products</h3>
        <h2>{{ total_products }}</h2>
    </div>

    <div class="card">
        <h3>Total Stock Value</h3>
        <h2>‚Çπ{{ total_stock_value }}</h2>
    </div>

    <div class="card">
        <h3>Total Customers</h3>
        <h2>{{ total_customers }}</h2>
    </div>
</div>
<h2 style="text-align:center; margin-top:30px;">üõí All Products</h2>

<table style="width:100%; border-collapse:collapse; margin-top:20px; text-align:center;">
<thead>
<tr style="background:#00eaff; color:#000;">
    <th>Image</th>
    <th>Name</th>
    <th>Category</th>
    <th>Price</th>
    <th>Actions</th>
</tr>
</thead>
<tbody>
{% for p in products %}
<tr style="background:#111; border-bottom:1px solid #333;">
    <td><img src="{{ p.image.url }}" width="60"></td>
    <td>{{ p.name }}</td>
    <td>{{ p.category }}</td>
    <td>‚Çπ{{ p.price }}</td>
    <td>
        <a href="{% url 'edit_product' p.id %}" style="color:yellow;">‚úè Edit</a> |
        <a href="{% url 'delete_product' p.id %}" style="color:red;" onclick="return confirm('Delete this Product?');">üóë Delete</a>
    </td>
</tr>
{% endfor %}
</tbody>
</table>


    <center>
        <div style="height: 25rem; width: 25rem; margin-bottom: 5rem;">
            <h2 style="text-align:center;">üìå Category-wise Products</h2>
            <canvas id="categoryChart"></canvas>
        </div>
        <br><br><br>
    </center>
<script>
    const categoryData = {{ category_data|safe }};
    const labels = categoryData.map(item => item.category);
    const values = categoryData.map(item => item.count);

    new Chart(document.getElementById('categoryChart'), {
        type:'pie',
        data:{
            labels: labels,
            datasets:[{
                data: values
            }]
        }
    });
</script>

<center>
    <a href="{% url 'home' %}" class="back-btn">‚¨Ö Back to Website</a>
</center>

</body>
</html>
